<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ì–‘ë™ì´ ì±—ë´‡ ë©”ì¸ í˜ì´ì§€</title>
<style>
  :root{
    --brand:#9ca3af; --brand-dark:#0f4aa4;
    --bg:#f3f6fb; --card:#ffffff;
    --text:#1f2a37; --muted:#6b7280;
    --shadow:0 8px 24px rgba(0,0,0,.06);
    --sbw:260px;
    --assist-shift: 120px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:var(--bg); color:var(--text);
    font-family:"Pretendard","Noto Sans KR",system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,"Malgun Gothic",sans-serif;
  }

  /* ===== Sidebar ===== */
  .sidebar{
    position:fixed; inset:0 auto 0 0; width:var(--sbw); height:100vh;
    background:linear-gradient(180deg,var(--brand),var(--brand-dark));
    color:#fff; display:flex; flex-direction:column; padding:18px 14px;
    transition:transform .25s ease; z-index:50;
  }
  body.sidebar-closed .sidebar{ transform:translateX(-100%); }

  .sb-top{display:flex; align-items:center; gap:10px; padding:8px 10px 14px 8px; border-bottom:1px solid rgba(255,255,255,.18); margin-bottom:12px;}
  .logo{display:flex; align-items:center; gap:10px; font-weight:700; font-size:18px;}
  .logo img{width:28px; height:28px; border-radius:50%; background:#fff}
  .sb-links{display:flex; flex-direction:column; gap:6px; padding:10px 0}
  .sb-item{
    display:flex; align-items:center; gap:10px; padding:12px; border-radius:10px;
    color:#eaf2ff; text-decoration:none; cursor:pointer; transition:background .18s ease;
  }
  .sb-item .icon{width:22px; height:22px; display:grid; place-items:center; background:rgba(255,255,255,.18); border-radius:8px; font-size:13px}
  .sb-item:hover{background:rgba(255,255,255,.14)}
  .sb-item.active{background:#fff; color:var(--brand)}
  .sb-bottom{margin-top:auto; display:flex; align-items:center; gap:10px; padding:10px 12px; opacity:.9}
  .sb-bottom img{width:44px; height:44px; border-radius:50%; background:#fff}
  .sb-bottom .role{font-size:12px; opacity:.9}

  /* ===== Main ===== */
  .main{ min-height:100vh; display:flex; flex-direction:column; margin-left:var(--sbw); transition:margin-left .25s ease; }
  body.sidebar-closed .main{ margin-left:0; }

  .topbar{
    height:64px; background:#fff; box-shadow:var(--shadow);
    padding:0 16px; display:flex; align-items:center; gap:8px; justify-content:space-between;
    position: sticky; top:0; z-index:60;
  }
  .auth-btn{ padding:6px 12px; border:none; border-radius:8px; cursor:pointer; background:#9ca3af; color:#fff; font-weight:600; transition:background .2s ease;}
  .auth-btn:hover{ background:#0f4aa4; }
  .left-group{display:flex; align-items:center; gap:8px;}
  .sb-toggle{
    border:none; background:transparent; width:40px; height:40px; border-radius:10px;
    font-size:18px; cursor:pointer; display:grid; place-items:center; color:#1f2a37;
  }
  .sb-toggle:hover{background:#eef3ff}
  .topbar .title{font-weight:700; font-size:18px}
  .right{display:flex; align-items:center; gap:12px; color:var(--muted)}

  .content{flex:1; padding:50px; position:relative;}
  
  .board{height:100%; display:grid; place-items:center;}
  .panel{
    width:min(1200px, 92%); margin: 40px auto 200px;
    background:#f7faff; border-radius:24px;
    box-shadow:inset 0 10px 18px rgba(0,0,0,.03), 0 18px 40px rgba(23,57,132,.08);
    padding:38px 36px;
  }
/* âœ¨ ì¹´ë“œ ì•ˆë‚´íŒ íš¨ê³¼ */
/* âœ¨ ì¹´ë“œ ì „ì²´ë¥¼ ë®ëŠ” íŒì—…í˜• ìŠ¤íƒ€ì¼ */
/* íŒ¨ë„ì„ ì˜¤ë²„ë ˆì´ ê¸°ì¤€ì ìœ¼ë¡œ */
/* íŒ¨ë„/ì˜¤ë²„ë ˆì´ ì•ˆì˜ íŠ¸ìœ„ëª¨ì§€ IMGëŠ” í•­ìƒ ì‘ê²Œ ê³ ì • */
.panel img.emoji,
.tile-overlay img.emoji,
.overlay-inner img.emoji {
  width: 24px !important;
  height: 24px !important;
  display: inline-block !important;
  vertical-align: -0.2em;
}
.panel{
    width:min(1200px, 92%); margin:40px auto 200px;
    background:#f7faff; border-radius:24px;
    box-shadow:inset 0 10px 18px rgba(0,0,0,.03), 0 18px 40px rgba(23,57,132,.08);
    padding:38px 36px;
  }
.tiles{display:grid; grid-template-columns:repeat(3,1fr); gap:18px;}
  .tile{
    background:#f9fbff; border-radius:18px; padding:50px; box-shadow:0 3px 0 #e3ecff inset, var(--shadow);
    display:flex; gap:14px; align-items:center; cursor:pointer; transition:transform .12s ease, box-shadow .12s ease;
    text-decoration:none; color:inherit;
  }
  .tile:hover{transform:translateY(-2px); box-shadow:0 10px 28px rgba(0,0,0,.08)}
  .tile .ic{width:56px; height:56px; border-radius:14px; display:grid; place-items:center; background:#e9f1ff; font-size:22px;}
  .tile .txt .k{font-weight:750}
  .tile .txt .s{font-size:13px; color:var(--muted); margin-top:2px}
/* âœ… ì•„ì´ì½˜ ê¸°ë³¸ ì„¤ì • (í¬ê¸° ê³ ì • + ê²¹ì¹¨ ë°©ì§€) */
.tile .ic {
  font-size: 40px !important;
  width: 48px !important;
  height: 48px !important;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  z-index: 2;
  transition: opacity 0.3s ease, visibility 0.3s ease;
}

.tile .ic img,
.tile .ic svg,
.tile .ic span,
.tile .ic::before {
  width: 48px !important;
  height: 48px !important;
  object-fit: contain;
  flex-shrink: 0;
}

/* âœ… ì˜¤ë²„ë ˆì´ (ì²˜ìŒì—” ìˆ¨ê¹€) */
.tile-overlay {
  position: absolute;
  inset: 0;
  background: #fff;
  border-radius: 24px;
  opacity: 0;
  transform: scale(0.97);
  transition: all 0.4s ease;
  pointer-events: none;
}

/* ë‚´ë¶€ í…ìŠ¤íŠ¸ */
.overlay-inner {
  padding: 40px;
}

.overlay-inner h3 {
  font-size: 22px;
  margin-bottom: 20px;
}

.overlay-inner ul {
  font-size: 16px;
  line-height: 1.7;
  margin-bottom: 25px;
}

.open-btn {
  background: var(--brand, #1565d8);
  color: #fff;
  border: none;
  padding: 10px 18px;
  border-radius: 10px;
  cursor: pointer;
}
.tile .ic img,
.tile .ic svg,
.tile .ic span,
.tile .ic twemoji,
.tile .ic * {
  max-width: 48px !important;
  max-height: 48px !important;
  width: 48px !important;
  height: 48px !important;
  flex-shrink: 0 !important;
  object-fit: contain !important;
  transform: none !important; /* ë¶€ëª¨ transform ë¬´ì‹œ */
  position: relative !important;
  z-index: 2 !important;
}

/* í´ë¦­ ì‹œ content ì¤‘ì•™ì— ë§ì¶° í™•ëŒ€ */
.tile.active {
  position: absolute;
  top: 80px;
  left: 50%;
  transform: translateX(-50%) scale(1);
  width: min(1100px, 90%);
  height: 600px;
  background: #ffffff;
  border-radius: 24px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.18);
  z-index: 200;
  transition: all 0.4s ease;
  overflow: hidden;
}

/* ì•„ì´ì½˜ / í…ìŠ¤íŠ¸ ìˆ¨ê¸°ê¸° */
.tile.active .txt,
.tile.active .ic {
  opacity: 0;
  visibility: hidden;
  transform: scale(0.9);
  transition: all 0.2s ease;
}

/* ë‚´ë¶€ í°ìƒ‰ íŒ¨ë„ */
.tile.active .tile-overlay {
  opacity: 1;
  pointer-events: auto;
  position: absolute;
  inset: 0;
  background: #fff;
  border-radius: 24px;
  transition: all 0.4s ease;
  box-shadow: none;
}

/* ë‚´ìš© ìì—°ìŠ¤ëŸ½ê²Œ ë“±ì¥ */
.tile.active .overlay-inner {
  opacity: 1;
  transform: translateY(0);
  transition: opacity 0.4s ease 0.1s, transform 0.4s ease 0.1s;
}

.tile .overlay-inner {
  opacity: 0;
  transform: translateY(10px);
  transition: opacity 0.2s ease, transform 0.2s ease;
}

  /* ===== Assistant ===== */
  .assistant-wrap{
    position: fixed; bottom: 100px;
    left: calc(var(--sbw) + (100vw - var(--sbw)) / 2 - var(--assist-shift));
    transform: translateX(-50%); display:flex; align-items:flex-end; gap:0; z-index:40;
    pointer-events:auto;
  }
  body.sidebar-closed .assistant-wrap{ left: calc(50% - var(--assist-shift)); transform: translateX(-50%); }
  .yang-stand{ width:400px; height:400px; object-fit:contain; filter:drop-shadow(0 12px 18px rgba(0,0,0,.22)); pointer-events:none; position:relative; top:100px; }
  .assistant-bar{ position:relative; height:64px; display:grid; grid-template-columns:120px 1fr 100px; align-items:center; gap:12px; background:#3c4250; color:#fff; border-radius:28px; padding:10px 12px; box-shadow:0 14px 30px rgba(0,0,0,.24); margin-left:-100px; width:min(860px, calc((100vw - var(--sbw)) - 300px - 70px)); transition:width .25s ease, margin-left .2s ease; pointer-events:auto; }
  .assistant-bar::after{ content:""; position:absolute; left:-10px; bottom:30px; width:18px; height:18px; background:#3c4250; transform:rotate(45deg); border-radius:3px; box-shadow:0 6px 12px rgba(0,0,0,.18); }
  body.sidebar-closed .assistant-bar{ width:min(960px, calc(100vw - 300px - 70px)); }
  .chip-icon{ width:40px; height:40px; border:none; border-radius:10px; background:rgba(255,255,255,.12); color:#fff; cursor:pointer; margin-right:6px; }
  .bar-left{display:flex; align-items:center}
  .bar-center input{ width:100%; height:44px; border:none; outline:none; background:rgba(255,255,255,.12); color:#fff; border-radius:12px; padding:0 12px; font-size:14px; }
  .mic, .send{ width:44px; height:44px; border:none; border-radius:12px; cursor:pointer; }
  .mic{ background:rgba(255,255,255,.12); color:#fff; margin-right:6px; }
  .send{ background:#9ca3af; color:#fff; font-weight:800; }

 /* === ğŸ’¬ ì±„íŒ… ë§í’ì„  UI === */
/* ğŸ’¬ ì±„íŒ… ë°•ìŠ¤ - ì‚¬ì´ë“œë°” êµ¬ì¡° ê¸°ì¤€ ì™„ë²½ ì •ë ¬ */
.chat-box {
  position: fixed;
  bottom: 155px; /* ğŸ”¥ ì…ë ¥ì°½ ìœ„ë¡œ ì •í™•íˆ ë„ìš°ê¸° */
  
  /* ì‚¬ì´ë“œë°” ìˆì„ ë•Œ */
  left: calc(var(--sbw) + (100vw - var(--sbw)) / 2 - var(--assist-shift));
  transform: translateX(-32%);
  
  width: min(840px, calc(100vw - var(--sbw) - 300px));
  max-height: 650px;
  overflow-y: auto; 
  background: #fff;
  border-radius: 20px;
  box-shadow: 0 12px 30px rgba(0, 0, 0, 0);
  z-index: 40; /* âœ… assistant-barë³´ë‹¤ ìœ„ */
  
  display: flex;  
  flex-direction: column;
  gap: 10px;
  padding: 20px;
  transition: all 0.3s ease;
}

/* ì‚¬ì´ë“œë°” ë‹«í˜ ì‹œ ì¤‘ì•™ì •ë ¬ ìœ ì§€ */
body.sidebar-closed .chat-box {
  left: 52%;
  transform: translateX(-50%);
  width: min(900px, calc(100vw - 300px));
}
.msg.user {
  background: #1565d8;
  color: #fff;
  border-radius: 18px 18px 2px 18px;
  padding: 10px 16px;
  margin: 8px 0 8px auto;
  width: fit-content;
  max-width: 75%;
}
.msg.bot {
  background: #f1f5ff;
  color: #1f2a37;
  border-radius: 18px 18px 18px 2px;
  padding: 10px 16px;
  margin: 8px auto 8px 0;
  width: fit-content;
  max-width: 75%;
}


  /* ====== íƒœë¸”ë¦¿ ê·œì¹™ ====== */
  @media (max-width:1100px){
    .tiles{grid-template-columns:repeat(2,1fr)}
    .assistant-wrap{ bottom:110px; }
    .assistant-bar{ grid-template-columns:100px 1fr 88px; }
  }

  /* ====== ëª¨ë°”ì¼ ê·œì¹™(í•µì‹¬) ====== */
  @media (max-width:768px){
    :root{ --sbw: 78vw; --assist-shift:0px; }

    /* ì‚¬ì´ë“œë°”: ê¸°ë³¸ ì ‘í˜(ì˜¤ë²„ë ˆì´ ëª¨ë“œ) */
    .sidebar{
      transform: translateX(-100%);
      z-index:100;
    }
    body.sb-open .sidebar{ transform: translateX(0); }
    /* ë°°ê²½ ë”¤ */
    .sb-dim{
      position: fixed; inset:0; background:rgba(0,0,0,.35);
      z-index:90; display:none;
    }
    body.sb-open .sb-dim{ display:block; }

    /* ë©”ì¸ ì¢Œì—¬ë°± ì œê±° */
    .main{ margin-left:0 !important; }
    .content{ padding:16px !important; }

    /* íŒ¨ë„/íƒ€ì¼ ì¶•ì†Œ + 1ì—´ */
    .panel{
      width:100% !important; margin:12px auto 120px !important;
      padding:16px !important; border-radius:14px !important;
      box-shadow:0 6px 16px rgba(0,0,0,.06) !important; background:#fff !important;
    }
    .tiles{ grid-template-columns:1fr !important; gap:12px !important; }
    .tile{ padding:16px !important; border-radius:12px !important; }

    /* ìºë¦­í„° ìˆ¨ê¹€ + ì±„íŒ…ë°” ì¤‘ì•™ */
    .yang-stand{ display:none !important; }
    /* ===== Assistant ===== */
/* ===== Assistant ===== */
.assistant-wrap {
  position: fixed;
  bottom: 80px; /* ìºë¦­í„° ë†’ì´ì— ë§ê²Œ ì¡°ì • ê°€ëŠ¥ (ê¸°ì¡´ 100px) */
  left: 50%; /* í™”ë©´ ì¤‘ì•™ ê¸°ì¤€ */
  transform: translateX(-50%); /* í•­ìƒ ì¤‘ì•™ ê³ ì • */
  display: flex;
  align-items: flex-end;
  justify-content: center;
  gap: 0;
  z-index: 40;
  pointer-events: auto;
  transition: all 0.3s ease;
}

/* ì‚¬ì´ë“œë°” ì—´ë¦¼/ë‹«í˜ì—ë„ ì˜í–¥ë°›ì§€ ì•Šê²Œ ê³ ì • */
body.sidebar-closed .assistant-wrap {
  left: 50%;
  transform: translateX(-50%);
}

/* ì–´ì‹œìŠ¤íŠ¸ ë°” ì¤‘ì•™ ì •ë ¬ */
.assistant-bar {
  position: relative;
  height: 64px;
  display: grid;
  grid-template-columns: 120px 1fr 100px;
  align-items: center;
  gap: 12px;
  background: #3c4250;
  color: #fff;
  border-radius: 28px;
  padding: 10px 12px;
  box-shadow: 0 14px 30px rgba(0,0,0,.24);
  /* margin-left:-100px; âŒ ì´ê±° ì‚­ì œ */
  width: min(860px, 80vw);
  transition: all 0.25s ease;
  pointer-events: auto;
}

.assistant-bar::after {
  content: "";
  position: absolute;
  left: -10px;
  bottom: 30px;
  width: 18px;
  height: 18px;
  background: #3c4250;
  transform: rotate(45deg);
  border-radius: 3px;
  box-shadow: 0 6px 12px rgba(0,0,0,.18);
}

    /* ì‚¬ì´ë“œë°” ì—´ë¦´ ë•Œ ì±„íŒ…ë°” ì•„ë˜ë¡œ */
    body.sb-open .assistant-wrap{ z-index:10; }
  }
/* ===== ì±„íŒ… ë°” ì •ì¤‘ì•™ ê³ ì • ===== */
.chat-bar {
  position: fixed;
  bottom: 25px;           /* ì–´ì‹œìŠ¤íŠ¸ë°” ë†’ì´ì— ë”°ë¼ ì¡°ì • */
  left: 50%;              /* í™”ë©´ ì¤‘ì•™ ê¸°ì¤€ */
  transform: translateX(-50%); /* ì •í™•íˆ ì¤‘ì•™ ì •ë ¬ */
  width: 65%;             /* ì „ì²´ í™”ë©´ ëŒ€ë¹„ ë¹„ìœ¨ */
  max-width: 950px;       /* ìµœëŒ€ ê¸¸ì´ ì œí•œ */
  min-width: 600px;       /* ìµœì†Œ ê¸¸ì´ ì œí•œ */
  background: #2d3641;
  border-radius: 40px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.25);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 6px 10px;
  transition: all 0.3s ease;
  z-index: 50;
}

/* ì‚¬ì´ë“œë°” ì—´ë¦¼/ë‹«í˜ ìƒíƒœì—ì„œë„ ì¤‘ì•™ ìœ ì§€ */
body.sidebar-closed .chat-bar {
  left: 50%;
  transform: translateX(-50%);
}

/* ì±„íŒ…ì°½ ë‚´ë¶€ input ë„ˆë¹„ ë³´ì • */
.chat-input {
  flex: 1;
  display: flex;
  justify-content: center;
  align-items: center;
}
.chat-input input {
  width: 100%;
  border: none;
  border-radius: 25px;
  padding: 10px 16px;
  font-size: 15px;
  outline: none;
  background: #3c4753;
  color: #fff;
}
  .sb-item .icon img.emoji{ width:16px; height:16px; display:block; }
  .tile .ic img.emoji{ width:28px; height:28px; display:block; }
  .chip-icon img.emoji, .mic img.emoji{ width:20px; height:20px; display:block; margin:0 auto; }
  
    /* === ì±„íŒ… ëª¨ë“œ ì „í™˜ === */
body.chatting .panel,
body.chatting .tiles {
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.4s ease;
}
/* âš™ï¸ ì„¤ì • íŒ¨ë„ ìŠ¤íƒ€ì¼ */
.settings-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.45);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 300;
  animation: fadeIn 0.3s ease;
}
.settings-overlay.active { display: flex; }

.settings-overlay.fade-out { animation: fadeOut 0.3s ease forwards; }

@keyframes fadeOut {
  from { opacity: 1; transform: translateY(0); }
  to { opacity: 0; transform: translateY(10px); }
}
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}
.settings-panel {
  background: #fff;
  padding: 40px 50px;
  border-radius: 24px;
  box-shadow: 0 20px 40px rgba(0,0,0,0.25);
  width: min(400px, 90%);
  animation: popUp 0.3s ease;
}
@keyframes popUp {
  from { transform: translateY(30px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

/* ğŸŒ™ ë‹¤í¬ëª¨ë“œ ì „í™˜ */
.switch {
  position: relative;
  display: inline-block;
  width: 46px;
  height: 24px;
}
.switch input { opacity: 0; width: 0; height: 0; }
.slider {
  position: absolute;
  cursor: pointer;
  top: 0; left: 0; right: 0; bottom: 0;
  background-color: #ccc;
  border-radius: 34px;
  transition: .3s;
}
.slider:before {
  position: absolute;
  content: "";
  height: 18px; width: 18px;
  left: 3px; bottom: 3px;
  background-color: white;
  border-radius: 50%;
  transition: .3s;
}
input:checked + .slider {
  background-color: var(--brand, #1565d8);
}
input:checked + .slider:before {
  transform: translateX(22px);
}

/* ğŸŒ™ ë‹¤í¬ëª¨ë“œ ë³¸ì²´ ìƒ‰ìƒ */
body.dark {
  --bg: #111827;
  --card: #1f2937;
  --text: #f3f4f6;
  --muted: #9ca3af;
  --brand: #3b82f6;
  --brand-dark: #2563eb;
  background: var(--bg);
  color: var(--text);
}
body.dark .panel,
body.dark .tile {
  background: var(--card);
  color: var(--text);
}
body.dark .assistant-bar {
  background: #374151;
}
/* âœ… ìº í¼ìŠ¤ ì•ˆë‚´ ì´ë¯¸ì§€ ë° ë¦¬ìŠ¤íŠ¸ */
.campus-map {
  text-align: center;
  margin-bottom: 12px;
}
.campus-map img {
  width: 100%;
  max-width: 550px;
  height: auto;
  object-fit: contain;
  border-radius: 10px;
  box-shadow: 0 4px 16px rgba(0,0,0,0.15);
}
.map-caption {
  font-size: 13px;
  color: var(--muted);
  margin-top: 6px;
}

/* âœ… ìŠ¤í¬ë¡¤ ì˜ì—­ ì„¤ì • */
.scroll-body {
  flex: 1 1 auto;
  max-height: 55vh;          /* ğŸ”¹ ì¹´ë“œ ë‚´ë¶€ ìµœëŒ€ ë†’ì´ */
  overflow-y: auto;          /* ì„¸ë¡œ ìŠ¤í¬ë¡¤ ê°€ëŠ¥ */
  padding-right: 8px;
  -webkit-overflow-scrolling: touch; /* ëª¨ë°”ì¼ ë¶€ë“œëŸ½ê²Œ */
  overscroll-behavior: contain;
}

/* âœ… ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
.campus-list {
  list-style: none;
  padding: 0;
  margin-top: 10px;
}
.campus-list li {
  background: var(--card);
  padding: 12px 14px;
  border-radius: 10px;
  margin-bottom: 10px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.05);
}
.campus-list h4 {
  margin: 0 0 4px;
  font-size: 16px;
  color: var(--brand-dark);
}
.campus-list .desc {
  color: var(--text);
  font-size: 14px;
  margin-bottom: 6px;
}
.scroll-body::-webkit-scrollbar {
  width: 8px;
}
.scroll-body::-webkit-scrollbar-thumb {
  background: rgba(0,0,0,0.2);
  border-radius: 8px;
}

/* âœ… í•™ê³¼ ë¦¬ìŠ¤íŠ¸ */
.dept-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

.dept-list li {
  background: var(--card);
  padding: 12px 14px;
  border-radius: 10px;
  margin-bottom: 10px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.05);
}

.dept-list h4 {
  margin: 0 0 4px;
  font-size: 16px;
  color: var(--brand-dark);
}

.dept-list button {
  background: var(--brand);
  color: #fff;
  border: none;
  border-radius: 6px;
  padding: 6px 12px;
  cursor: pointer;
  font-size: 13px;
  transition: 0.2s;
}

.dept-list button:hover {
  background: var(--brand-dark);
}
/* âœ… ê°œë³„ í•™ê³¼ ìƒì„¸ ì˜¤ë²„ë ˆì´ */
.dept-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.5);
  backdrop-filter: blur(6px);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}
.dept-content {
  background: var(--card, #fff);
  color: var(--text, #1f2a37);
  border-radius: 16px;
  width: 70%;
  max-height: 80%;
  overflow-y: auto;
  box-shadow: 0 12px 36px rgba(0,0,0,0.3);
  padding: 30px;
  animation: fadeIn 0.3s ease;
}
.close-btn {
  position: absolute;
  top: 20px;
  right: 24px;
  font-size: 24px;
  background: none;
  border: none;
  cursor: pointer;
  color: var(--text, #333);
}
@keyframes fadeIn {
  from {opacity: 0; transform: translateY(10px);}
  to {opacity: 1; transform: translateY(0);}
}

</style>
</head>
<body class="sidebar-closed">
  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
    <div class="sb-top">
      <div class="logo"><img src="image/yangdongi.png" alt="ì–‘ë™ì´"><span>ì–‘ë™ì´</span></div>
    </div>

    <nav class="sb-links">
    <!-- 1ï¸âƒ£ ìƒˆ ì±„íŒ… ë²„íŠ¼ -->
    <a class="sb-item active" id="newChatBtn" href="#">
      <span class="icon">ğŸ’¬</span>
      <span>ìƒˆ ì±„íŒ…</span>
    </a>

    <!-- 2ï¸âƒ£ ì„¤ì • ë²„íŠ¼ -->
    <a class="sb-item" href="#">
      <span class="icon">âš™ï¸</span>
      <span>ì„¤ì •</span>
    </a>
  </nav>

    <!-- #ï¸âƒ£ ì‚¬ìš©ì ì •ë³´ê°€ ì±„ì›Œì§ˆ ì˜ì—­ -->
    <div class="sb-bottom" id="userBox">
      <img src="image/user.png" alt="ì‚¬ìš©ì">
      <div class="info">
        <div><strong id="userName">ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤</strong></div>
        <div class="role" id="userMeta">-</div>
      </div>
    </div>
  </aside>

  <!-- Main -->
  <main class="main">
    <header class="topbar">
      <div class="left-group">
        <button class="sb-toggle" id="toggleBtn">â˜°</button>
        <div class="title">ì–‘ë™ì´ ì±—ë´‡ 1.0 </div>
      </div>

      <!-- #ï¸âƒ£ ë¡œê·¸ì¸ ìƒíƒœì— ë”°ë¼ ìˆ¨ê¸¸ ë²„íŠ¼ -->
      <div class="right">
        <span class="muted" id="todayText"></span>
        <button id="authBtn" class="auth-btn"></button>
        <button id="logoutBtn" class="auth-btn" style="display:none">ë¡œê·¸ì•„ì›ƒ</button>
      </div>
    </header>

<section class="content">
  <div class="board">
    <div class="panel">
      <div class="tiles">
      <!-- 1ï¸âƒ£ ì…í•™ ì•ˆë‚´ -->
      <div class="tile">
        <div class="ic">ğŸ«</div>
        <div class="txt">
          <div class="k">ì…í•™ ì•ˆë‚´</div>
          <div class="s">ëª¨ì§‘ìš”ê°• / ì§€ì›ìê²© / ì „í˜•ì¼ì •</div>
        </div>

        <div class="tile-overlay">
          <div class="overlay-inner">
            <h3>ğŸ« ì…í•™ ì•ˆë‚´</h3>
            <ul id="admission-list">
              <li>ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</li>
            </ul>
            <button class="open-btn" id="admission-btn">ì…í•™ í™ˆí˜ì´ì§€ë¡œ ì´ë™</button>
          </div>
        </div>
      </div>


          <!-- 2ï¸âƒ£ í•™ê³¼ ì†Œê°œ -->
          <div class="tile" onclick="loadDepartments()">
            <div class="ic">ğŸ“š</div>
            <div class="txt">
              <div class="k">í•™ê³¼ ì†Œê°œ</div>
              <div class="s">ë™ì–‘ë¯¸ë˜ëŒ€í•™êµ í•™ê³¼ë³„ ì•ˆë‚´</div>
            </div>

            <div class="tile-overlay">
              <div class="overlay-inner">
                <h3>ğŸ“š í•™ê³¼ ì†Œê°œ</h3>

                <div class="scroll-body" id="deptContainer">
                  <p>ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
                </div>
              </div>
            </div>
          </div>

          <!-- âœ… ê°œë³„ í•™ê³¼ ìƒì„¸ ì˜¤ë²„ë ˆì´ -->
          <div id="deptOverlay" class="dept-overlay" style="display:none;">
            <div class="dept-content">
              <button class="close-btn" onclick="closeDeptDetail()">Ã—</button>
              <div id="deptDetail"><p>ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p></div>
            </div>
          </div>

          <!-- âœ… ìº í¼ìŠ¤ ì•ˆë‚´ ì¹´ë“œ -->
          <div class="tile" onclick="loadCampusInfo()">
            <div class="ic">ğŸŒ³</div>
            <div class="txt">
              <div class="k">ìº í¼ìŠ¤ ì•ˆë‚´</div>
              <div class="s">í•™êµ ìœ„ì¹˜ / ê±´ë¬¼ ì•ˆë‚´</div>
            </div>

          <div class="tile-overlay">
            <div class="overlay-inner">
              <h3>ğŸ« ìº í¼ìŠ¤ ê±´ë¬¼ ì•ˆë‚´</h3>

              <!-- âœ… ì§€ë„ ì´ë¯¸ì§€ -->
              <div class="campus-map">
                <img src="/image/campus_map.png" alt="ë™ì–‘ë¯¸ë˜ëŒ€í•™êµ ìº í¼ìŠ¤ ì§€ë„">
                <p class="map-caption">ë™ì–‘ë¯¸ë˜ëŒ€í•™êµ ìº í¼ìŠ¤ ì•ˆë‚´ë„</p>
              </div>

              <!-- âœ… ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•œ ì½˜í…ì¸  -->
              <div class="scroll-body" id="campusContainer">
                <p>ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
              </div>
            </div>
          </div>
        </div>



        
</section>
<!-- ğŸ’¬ ì±„íŒ… ë§í’ì„  ë°•ìŠ¤ -->
<div class="chat-box" id="chatBox"></div>

      <!-- Assistant -->
      <div class="assistant-wrap">
        <img class="yang-stand" src="image/yangdongi.png" alt="ì–‘ë™ì´">
        <div class="assistant-bar">
          <div class="bar-left">
            <button class="chip-icon">ğŸŒ</button>
            <button class="chip-icon">ğŸ“˜</button>
            <button class="chip-icon">âš™ï¸</button>
          </div>
          <div class="bar-center"><input id="ask" type="text" placeholder="ì•ˆë…•! ë‚œ ì–‘ë™ì´ì•¼. ì–´ë–¤ ì ì´ ê¶ê¸ˆí•´?" /></div>
          <div class="bar-right" style="display:flex;align-items:center;gap:6px;">
            <button class="mic">ğŸ™</button>
            <button class="send" onclick="send()">âœ</button>
          </div>
        </div>
      </div>
      <!-- âš™ï¸ ì„¤ì • íŒ¨ë„ (ë‹¤í¬ëª¨ë“œ ì „ìš©) -->
<div class="settings-overlay" id="settingsOverlay">
  <div class="settings-panel">
    <h2>âš™ï¸ ì„¤ì •</h2>

    <!-- ğŸŒ™ ë‹¤í¬ëª¨ë“œ ìŠ¤ìœ„ì¹˜ -->
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;">
      <span style="font-weight:600;">ë‹¤í¬ ëª¨ë“œ</span>
      <label class="switch">
        <input type="checkbox" id="darkModeToggle" onchange="toggleDarkMode(this.checked)">
        <span class="slider"></span>
      </label>
    </div>

    <div style="margin-top:20px; display:flex; justify-content:flex-end;">
      <button class="btn" onclick="closeSettingsPanel()">ë‹«ê¸°</button>
    </div>
  </div>
</div>
    </section>
  </main>

  <!-- ëª¨ë°”ì¼ ì˜¤ë²„ë ˆì´ ë”¤ -->
  <div class="sb-dim"></div>

  <!-- Twemoji -->
  <!-- âœ… TwemojiëŠ” ì´ í•œ ë²ˆë§Œ ì¡´ì¬í•´ì•¼ í•¨ -->
<!-- twemoji ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ (í•œ ë²ˆë§Œ) -->
<script src="https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js" crossorigin="anonymous"></script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
  // âœ… ì¹´ë“œ ì•„ì´ì½˜ê³¼ íŒ¨ë„ ë‚´ë¶€ ì•„ì´ì½˜(ì œëª© í¬í•¨) ëª¨ë‘ Twemoji ì ìš©
  twemoji.parse(document.body, { folder: 'svg', ext: '.svg' });
});

  // ì˜¤ëŠ˜ ë‚ ì§œ
  (function(){
    const el=document.getElementById('todayText');
    const d=new Date(); const w=['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '][d.getDay()];
    el.textContent=`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')} ${w}`;
  })();

  // Sidebar toggle (ë°ìŠ¤í¬í†±: ì ‘ê¸°/í¼ì¹˜ê¸°, ëª¨ë°”ì¼: ì˜¤ë²„ë ˆì´ ì—´ê¸°/ë‹«ê¸°)
  const toggleBtn = document.getElementById('toggleBtn');
  const dim = document.querySelector('.sb-dim');
  function isMobile(){ return window.innerWidth <= 768; }
  function closeAllSidebars(){ document.body.classList.remove('sb-open'); // ëª¨ë°”ì¼ ì˜¤ë²„ë ˆì´ ë‹«ê¸°
    // ë°ìŠ¤í¬í†±ì—ì„  ê¸°ë³¸ í¼ì¹¨ ìƒíƒœ ìœ ì§€(ì›í•˜ë©´ ì•„ë˜ ì¤„ì„ ì£¼ì„ í•´ì œ)
    // document.body.classList.add('sidebar-closed');
  }

  toggleBtn.addEventListener('click', ()=>{
    if (isMobile()){
      document.body.classList.toggle('sb-open');
    } else {
      document.body.classList.toggle('sidebar-closed');
    }
  });

  // ë”¤ í´ë¦­ ì‹œ ë‹«ê¸°
  dim.addEventListener('click', closeAllSidebars);
  // í™”ë©´ í¬ê¸° ë³€ê²½ ì‹œ ëª¨ë“œ ì •ë¦¬
  window.addEventListener('resize', ()=>{
    if (isMobile()){
      // ëª¨ë°”ì¼ì—ì„œëŠ” ë©”ì¸ì€ í•­ìƒ ì¢Œì—¬ë°± ì—†ìŒ, ì‚¬ì´ë“œë°”ëŠ” ê¸°ë³¸ ë‹«í˜
      document.body.classList.add('sidebar-closed');
    } else {
      // ë°ìŠ¤í¬í†±ì—ì„œëŠ” ì˜¤ë²„ë ˆì´ ëª¨ë“œ í•´ì œ
      document.body.classList.remove('sb-open');
    }
  });

  function send(){
    const v=document.getElementById('ask').value.trim();
    if(!v) return;
    console.log('[ASK]',v);
    document.getElementById('ask').value='';
  }

  // âœ… ë¡œê·¸ì•„ì›ƒ
  async function logout(){
    try {
      await fetch("/api/logout", { method:"POST", credentials:"include" }).catch(()=>{});
    } catch(_) {}
    localStorage.removeItem("isLoggedIn");
    localStorage.removeItem("isGuest");
    sessionStorage.clear();
    location.href = "login.html";
  }

  // #ï¸âƒ£ ì„¸ì…˜ ì •ë³´ â†’ ì¢Œì¸¡ í•˜ë‹¨ ë°•ìŠ¤ & ë²„íŠ¼ ìƒíƒœ
  async function hydrateUserUI() {
    try {
      const res = await fetch("/api/me", { credentials: "include" });
      const data = await res.json().catch(()=> ({}));

      const btn = document.getElementById("authBtn");
      const logoutBtn = document.getElementById("logoutBtn");
      const nameEl = document.getElementById("userName");
      const metaEl = document.getElementById("userMeta");

      if (res.ok && data.ok && data.user) {
        const u = data.user;
        nameEl.textContent = u.name || "ì´ë¦„ ì—†ìŒ";
        metaEl.innerHTML = `${u.uid || "-"}<br>${u.department || "-"}`;

        if (btn) btn.style.display = "none";
        if (logoutBtn) {
          logoutBtn.style.display = "inline-flex";
          logoutBtn.onclick = logout;
        }
      } else {
        if (btn) {
          btn.textContent = "ë¡œê·¸ì¸";
          btn.onclick = ()=> location.href="login.html";
          btn.style.display = "inline-flex";
        }
        if (logoutBtn) logoutBtn.style.display = "none";
      }
    } catch (e) {
      console.warn("ì„¸ì…˜ ì¡°íšŒ ì‹¤íŒ¨", e);
    }
  }
  hydrateUserUI();
document.addEventListener('DOMContentLoaded', function(){
  const tiles = document.querySelectorAll('.tile');
  let activeTile = null;

  tiles.forEach(tile => {
    tile.addEventListener('click', (e) => {
      e.stopPropagation();

      // ì´ë¯¸ ì—´ë ¤ ìˆëŠ” ì¹´ë“œ ë‹¤ì‹œ í´ë¦­ â†’ ë‹«ê¸°
      if (tile.classList.contains('active')) {
        tile.classList.remove('active');
        activeTile = null;
        return;
      }

      // ë‹¤ë¥¸ ì¹´ë“œ ë‹«ê¸°
      if (activeTile) activeTile.classList.remove('active');

      // ìƒˆ ì¹´ë“œ ì—´ê¸°
      tile.classList.add('active');
      activeTile = tile;
    });
  });

  // ë°”ê¹¥ í´ë¦­ ì‹œ ë‹«ê¸°
  document.addEventListener('click', (e) => {
    if (activeTile && !activeTile.contains(e.target)) {
      activeTile.classList.remove('active');
      activeTile = null;
    }
  });
});

// âœ… FastAPI ì„œë²„ ì£¼ì†Œ (AI ë°±ì—”ë“œ)
const API_BASE = "http://127.0.0.1:9000";  // â† app.py ì‹¤í–‰ ì¤‘ì¸ ì£¼ì†Œë¡œ ë§ì¶°ì•¼ í•¨

// âœ… 1ï¸âƒ£ í…ìŠ¤íŠ¸ ì…ë ¥ â†’ FastAPI RAG ëŒ€í™” ì—°ê²°
async function send() {
  const input = document.getElementById("ask");
  const text = input.value.trim();
  if (!text) return;

  const box = document.getElementById("chatBox");
  input.value = "";

  // ì‚¬ìš©ì ë§í’ì„  í‘œì‹œ
  box.innerHTML += `<div class="msg user">ğŸ§‘â€ğŸ’» ${text}</div>`;
  box.scrollTop = box.scrollHeight;

  try {
    // --- (1) GPT ëŒ€í™” ìš”ì²­ ---
    const chatRes = await fetch(`${API_BASE}/rag/chat`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ query: text })  // ğŸ‘ˆ FastAPIì— query ì „ë‹¬
    });
    const data = await chatRes.json();

    // --- (2) ë´‡ ì‘ë‹µ í‘œì‹œ ---
    box.innerHTML += `<div class="msg bot">ğŸ¤– ${data.answer}</div>`;
    box.scrollTop = box.scrollHeight;

    // --- (3) TTS ìŒì„± ë³€í™˜ ìš”ì²­ ---
    const ttsRes = await fetch(`${API_BASE}/tts`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ text: data.answer })
    });
    if (ttsRes.ok) {
      const tts = await ttsRes.json();
      new Audio(`data:audio/mpeg;base64,${tts.audio_b64}`).play(); // ğŸ‘ˆ ë°”ë¡œ ì¬ìƒ
    }

  } catch (e) {
    box.innerHTML += `<div class="msg bot">âš ï¸ ì„œë²„ ì—°ê²° ì‹¤íŒ¨: ${e.message}</div>`;
  }
}

// âœ… 2ï¸âƒ£ ìŒì„± ì…ë ¥ â†’ FastAPI ìŒì„±(STT) ëŒ€í™” ì—°ê²°
let mediaRecorder, audioChunks = [];
document.querySelector(".mic").addEventListener("click", async () => {

  // ë‹¤ì‹œ í´ë¦­í•˜ë©´ ë…¹ìŒ ì¢…ë£Œ
  if (mediaRecorder && mediaRecorder.state === "recording") {
    mediaRecorder.stop();
    return;
  }

  try {
    // --- ë§ˆì´í¬ ë…¹ìŒ ì‹œì‘ ---
    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
    mediaRecorder = new MediaRecorder(stream);
    audioChunks = [];

    mediaRecorder.ondataavailable = e => audioChunks.push(e.data);
    mediaRecorder.onstop = async () => {
      const blob = new Blob(audioChunks, { type: "audio/webm" });
      const fd = new FormData();
      fd.append("file", blob, "voice.webm");

      // --- (4) FastAPIë¡œ ì „ì†¡ ---
      const res = await fetch(`${API_BASE}/voice-chat`, {
        method: "POST",
        body: fd
      });
      const d = await res.json();

      // --- (5) ì‘ë‹µ í‘œì‹œ ---
      const box = document.getElementById("chatBox");
      box.innerHTML += `<div class="msg user">ğŸ™ï¸ ${d.user_text}</div>`;
      box.innerHTML += `<div class="msg bot">ğŸ¤– ${d.assistant_text}</div>`;
      box.scrollTop = box.scrollHeight;

      // --- (6) ë´‡ ìŒì„± ì¬ìƒ ---
      new Audio(`data:audio/mpeg;base64,${d.audio_b64}`).play();
    };

    mediaRecorder.start();
    alert("ğŸ™ï¸ ë…¹ìŒ ì‹œì‘! ë‹¤ì‹œ ëˆ„ë¥´ë©´ ì¢…ë£Œë©ë‹ˆë‹¤.");

  } catch (err) {
    alert("ë§ˆì´í¬ ê¶Œí•œì„ í—ˆìš©í•´ì£¼ì„¸ìš”!");
  }
});

// ìƒˆ ì±„íŒ… ë²„íŠ¼ í´ë¦­ ì‹œ ëŒ€í™”ì°½ ì´ˆê¸°í™”
  document.getElementById("newChatBtn").addEventListener("click", function (e) {
    e.preventDefault();

    const chatBox = document.querySelector(".chat-box"); // ì±„íŒ… ë‚´ìš© ì˜ì—­
    const input = document.querySelector(".chat-input input"); // ì…ë ¥ì°½

    if (chatBox) {
      chatBox.innerHTML = ""; // ëª¨ë“  ëŒ€í™” ë‚´ìš© ì‚­ì œ
    }
    if (input) {
      input.value = ""; // ì…ë ¥ì°½ ë¹„ìš°ê¸°
    }

    // ì‚¬ìš©ì í”¼ë“œë°± ë©”ì‹œì§€ ì¶œë ¥
    const msg = document.createElement("div");
    msg.classList.add("system-message");
    msg.style.textAlign = "center";
    msg.style.color = "#6b7280";
    msg.style.margin = "20px 0";
    msg.textContent = " ìƒˆë¡œìš´ ì±„íŒ…ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.";
    chatBox.appendChild(msg);
  }); /*ì´ê±° ë‚´êº¼ë¡œ ìƒˆ ì±„íŒ…í• ì§€ ì§€ì•ˆêº¼ ìƒˆ ì±„íŒ…ì„ í• ì§€ ê²°ì •*/

async function send() {
  const input = document.getElementById("ask");
  const text = input.value.trim();
  if (!text) return;

  // âœ… ì¹´ë“œ ìˆ¨ê¸°ê¸°
  document.body.classList.add("chatting");

  const box = document.getElementById("chatBox");
  input.value = "";

  box.innerHTML += `<div class="msg user">ğŸ§‘â€ğŸ’» ${text}</div>`;
  box.scrollTop = box.scrollHeight;

  try {
    const chatRes = await fetch(`${API_BASE}/rag/chat`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ query: text })
    });
    const data = await chatRes.json();

    box.innerHTML += `<div class="msg bot">ğŸ¤– ${data.answer}</div>`;
    box.scrollTop = box.scrollHeight;

    const ttsRes = await fetch(`${API_BASE}/tts`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ text: data.answer })
    });
    if (ttsRes.ok) {
      const tts = await ttsRes.json();
      new Audio(`data:audio/mpeg;base64,${tts.audio_b64}`).play();
    }

  } catch (e) {
    box.innerHTML += `<div class="msg bot">âš ï¸ ì„œë²„ ì—°ê²° ì‹¤íŒ¨: ${e.message}</div>`;
  }
}
// âš™ï¸ ì„¤ì •ì°½ ë‹«ê¸° í•¨ìˆ˜ ë‹«ê¸° ë²„íŠ¼ ì•ˆëˆŒë ¤ì§€ëŠ”ê±° ìˆ˜ì • ì½”ë“œ
  function closeSettingsPanel() {
    const overlay = document.getElementById("settingsOverlay");
    if (overlay) {
      // 1ï¸âƒ£ í˜ì´ë“œì•„ì›ƒ ì• ë‹ˆë©”ì´ì…˜ í´ë˜ìŠ¤ ì¶”ê°€
      overlay.classList.add("fade-out");

      // 2ï¸âƒ£ 0.3ì´ˆ í›„ ì™„ì „íˆ ë‹«ê¸°
      setTimeout(() => {
        overlay.classList.remove("active");
        overlay.classList.remove("fade-out");
      }, 300);
    }
  }
  // ğŸŒ™ ë‹¤í¬ëª¨ë“œ í† ê¸€
function toggleDarkMode(isOn) {
  if (isOn) {
    document.body.classList.add("dark");
    localStorage.setItem("theme", "dark");
  } else {
    document.body.classList.remove("dark");
    localStorage.setItem("theme", "light");
  }
}

// ğŸŒ™ ì €ì¥ëœ í…Œë§ˆ ë³µì›
function restoreTheme() {
  const savedTheme = localStorage.getItem("theme");
  const darkToggle = document.getElementById("darkModeToggle");
  if (savedTheme === "dark") {
    document.body.classList.add("dark");
    if (darkToggle) darkToggle.checked = true;
  }
}
document.addEventListener("DOMContentLoaded", restoreTheme);

// âš™ï¸ ì„¤ì • ì—´ê¸° / ë‹«ê¸°
document.addEventListener("DOMContentLoaded", function() {
  // âš™ï¸ ì•„ì´ì½˜ì„ í¬í•¨í•œ ë‘ ë²ˆì§¸ ë©”ë‰´ í•­ëª©(ì„¤ì • ë²„íŠ¼)ì„ ì°¾ì•„ í´ë¦­ ì´ë²¤íŠ¸ ë“±ë¡
  const settingsLinks = document.querySelectorAll(".sb-item");
  settingsLinks.forEach(link => {
    if (link.textContent.includes("ì„¤ì •")) {  // âš™ï¸ í…ìŠ¤íŠ¸ë¡œ íƒìƒ‰
      link.addEventListener("click", (e) => {
        e.preventDefault();
        document.getElementById("settingsOverlay").classList.add("active");
      });
    }
  });
});
// ===== ìº í¼ìŠ¤ ì•ˆë‚´ ë¶ˆëŸ¬ì˜¤ê¸° =====
async function loadCampusInfo() {
  const box = document.getElementById("campusContainer");
  box.innerHTML = `<p>ğŸ« ìº í¼ìŠ¤ ì•ˆë‚´ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>`;

  try {
    const res = await fetch("/api/campus/place");
    const data = await res.json();

    if (!data.ok || !data.places?.length) {
      box.innerHTML = `<p>ğŸ“­ ì•ˆë‚´ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</p>`;
      return;
    }

    box.innerHTML = `
      <ul class="campus-list">
        ${data.places.map(p => `
          <li>
            <h4>${p.title}</h4>
            <p class="desc">${p.content}</p>
            <p><b>ë‹´ë‹¹ë¶€ì„œ:</b> ${p.manager} | <b>ì „í™”:</b> ${p.phone}</p>
          </li>
        `).join("")}
      </ul>
    `;
  } catch (err) {
    console.error("ìº í¼ìŠ¤ ì•ˆë‚´ ë¡œë“œ ì˜¤ë¥˜:", err);
    box.innerHTML = `<p>âŒ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</p>`;
  }
}


// ===== í•™ê³¼ ë¦¬ìŠ¤íŠ¸ ë¶ˆëŸ¬ì˜¤ê¸° =====
async function loadDepartments() {
  const box = document.getElementById("deptContainer");
  box.innerHTML = `<p>ğŸ“š í•™ê³¼ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>`;

  try {
    const res = await fetch("/api/department/list");
    const data = await res.json();

    if (!data.ok || !data.departments?.length) {
      box.innerHTML = `<p>ğŸ“­ í•™ê³¼ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</p>`;
      return;
    }

    box.innerHTML = `
      <ul class="dept-list">
        ${data.departments.map(d => `
          <li class="dept-item" onclick="loadDepartmentDetail('${d.name}')">
            <h4>${d.name}</h4>
            <p class="desc">${d.desc || "í•™ê³¼ ì†Œê°œ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤."}</p>
            ${d.link ? `<button onclick="event.stopPropagation();window.open('${d.link}','_blank')">í•™ê³¼ í™ˆí˜ì´ì§€ ì´ë™</button>` : ""}
          </li>
        `).join("")}
      </ul>
    `;
  } catch (err) {
    console.error("í•™ê³¼ ì •ë³´ ë¡œë“œ ì˜¤ë¥˜:", err);
    box.innerHTML = `<p>âŒ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</p>`;
  }
}

// ===== ê°œë³„ í•™ê³¼ ìƒì„¸ ë³´ê¸° =====
async function loadDepartmentDetail(name) {
  const overlay = document.getElementById("deptOverlay");
  const box = document.getElementById("deptDetail");

  overlay.style.display = "flex";
  box.innerHTML = `<p>ğŸ” ${name} í•™ê³¼ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>`;

  try {
    const res = await fetch(`/api/department/${name}`);
    const data = await res.json();

    if (!data.ok) {
      box.innerHTML = `<p>âŒ ${name} í•™ê³¼ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>`;
      return;
    }

    const d = data.department;
    let html = `<h2>${d["í•™ê³¼ëª…"]}</h2>`;

    // ğŸ“ êµìœ¡ê³¼ì •
    if (d["êµìœ¡ê³¼ì •"]?.length) {
      html += `<h3>ğŸ“ êµìœ¡ê³¼ì •</h3><ul>`;
      d["êµìœ¡ê³¼ì •"].forEach(sub => {
        html += `<li>${sub["êµê³¼ëª©ëª…"]} (${sub["ì´ìˆ˜êµ¬ë¶„"]}, ${sub["í•™ì "]}í•™ì )</li>`;
      });
      html += `</ul>`;
    }

    // ğŸ‘¨â€ğŸ« êµìˆ˜ì†Œê°œ
    if (d["êµìˆ˜ì†Œê°œ"]) {
      html += `<h3>ğŸ‘¨â€ğŸ« êµìˆ˜ì§„</h3><ul>`;
      for (const [prof, info] of Object.entries(d["êµìˆ˜ì†Œê°œ"])) {
        html += `<li><b>${prof}</b> â€” ${info["ì „ê³µë¶„ì•¼"] || ""} (${info["ì´ë©”ì¼"] || ""})</li>`;
      }
      html += `</ul>`;
    }

    // ğŸ« ì „ê³µë™ì•„ë¦¬
    if (d["ì „ê³µë™ì•„ë¦¬"]) {
      html += `<h3>ğŸ« ì „ê³µë™ì•„ë¦¬</h3>`;
      for (const [club, info] of Object.entries(d["ì „ê³µë™ì•„ë¦¬"])) {
        html += `
          <div class="club">
            <b>${info["ì „ê³µë™ì•„ë¦¬ ì´ë¦„"]}</b> (${info["ì§€ë„êµìˆ˜"] || ""})<br>
            <p>${info["ë™ì•„ë¦¬ ì†Œê°œ"] || ""}</p>
          </div>
        `;
      }
    }

    // ğŸ’¼ ì¡¸ì—… í›„ ì§„ë¡œ
    if (d["í•™ê³¼ì†Œê°œ(ì¡¸ì—… í›„ ì§„ë¡œ)"]) {
      const career = d["í•™ê³¼ì†Œê°œ(ì¡¸ì—… í›„ ì§„ë¡œ)"];
      html += `<h3>ğŸ’¼ ì¡¸ì—… í›„ ì§„ë¡œ</h3>`;
      if (career["ì·¨ì—…ë¶„ì•¼"]) html += `<p>ì·¨ì—…ë¶„ì•¼: ${career["ì·¨ì—…ë¶„ì•¼"].join(", ")}</p>`;
      if (career["ì·¨ì—…ì—…ì²´"]) html += `<p>ì·¨ì—…ì—…ì²´: ${career["ì·¨ì—…ì—…ì²´"].join(", ")}</p>`;
      if (career["ì·¨ë“ê°€ëŠ¥ìê²©ì¦"]) html += `<p>ìê²©ì¦: ${career["ì·¨ë“ê°€ëŠ¥ìê²©ì¦"].join(", ")}</p>`;
    }

    box.innerHTML = html;
  } catch (err) {
    console.error("ìƒì„¸ì •ë³´ ë¡œë“œ ì˜¤ë¥˜:", err);
    box.innerHTML = `<p>âŒ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</p>`;
  }
}

// ===== ìƒì„¸ ë‹«ê¸° =====
function closeDeptDetail() {
  const overlay = document.getElementById("deptOverlay");
  overlay.style.display = "none";
}
// ===== ì…í•™ ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸° =====
async function loadAdmissionInfo() {
  const ul = document.getElementById("admission-list");
  ul.innerHTML = `<li>ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</li>`;
  try {
    const res = await fetch("/api/admission/info");
    const data = await res.json();
    if (!data.ok) {
      ul.innerHTML = `<li>âŒ ${data.msg || "ì…í•™ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤."}</li>`;
      return;
    }

    const info = data.info;
    ul.innerHTML = `
      <li>ëª¨ì§‘ ì‹œê¸°: ${info.ëª¨ì§‘ì‹œê¸°}</li>
      <li>ì§€ì› ìê²©: ${info.ì§€ì›ìê²©}</li>
      <li>ì „í˜• ë°©ë²•: ${info.ì „í˜•ë°©ë²•}</li>
    `;

    // âœ… ë²„íŠ¼: PDFë¥¼ ìƒˆ íƒ­ì—ì„œ ì—´ê¸°
document.getElementById("admission-btn").onclick = () => {
  window.open("https://ipsi.dongyang.ac.kr/dongyang_ipsi/501/subview.do", "_blank");
};
  } catch (e) {
    ul.innerHTML = `<li>âŒ ì˜¤ë¥˜: ${e.message}</li>`;
  }
}

document.addEventListener("DOMContentLoaded", loadAdmissionInfo);



</script>

</body>
</html>
